<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <style>.col-centered{
                float: none;
                margin: 0 auto;
            }
    </style>
</head>
    <body>
    <div class="col-lg-6 col-centered">
        <h1 class="text-center">Chrome Memory Leak</h1>
        <h5 class="text-center">Michael Bilstein - September 21st, 2016</h5>
        <p>This page shows a memory leak in Chrome 53.</p>
        <h2 class="text-center">JUST KIDDING. THIS ACTUALLY HAPPENS EVERYWHERE. Just refresh a page a few times. Memory won't decrease until you go to another domain.</h2>
        <h2 class="text-center">See <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=270000&can=2&q=270000&colspec=ID%20Pri%20M%20Stars%20ReleaseBlock%20Component%20Status%20Owner%20Summary%20OS%20Modified">chromium bug 270000</a> for more information</h2>
        <p>In order to reproduce the leak, just block the images from this site by clicking on the information icon next to the link in the omnibar. Once you have blocked images, just keep refreshing the page and watch the memory usage increase.</p>
        <h3 class="text-center">The problem:</h3>
        <p>Nodes with blocked images do not get deleted/dereferenced when the user navigates to another page.</p>
        <p>The entire page cannot then be dereferenced.</p>
        <p>The memory usage will continue to rise as the user encounters more of these nodes, until the window is closed.</p>
        <h3 class="text-center">What I believe causes this leak:</h3>
        <p>The problematic nodes are not able to be deleted by the garbage collector because they still reference elements that are waiting for an image to load.</p>
        <h3 class="text-center">Possible solution:</h3>
        <p>When a DOM node fails to load an image and images are blocked on the browser, dereference it.</p>
        <p>Alternatively, assert that when the user leaves a page, that it get's its contents deleted:</p>
        <code>
            window.addEventListener('unload', function () {
                document.documentElement.innerHTML = '';
            });
        </code>
        <h3 class="text-center">Images to fail:</h3>
        <div>Image0: <img src="https://i.kinja-img.com/gawker-media/image/upload/s--pEKSmwzm--/c_scale,fl_progressive,q_80,w_800/1414228815325188681.jpg"></div>
        <div>Image1: <img src="https://i.kinja-img.com/gawker-media/image/upload/s--pEKSmwzm--/c_scale,fl_progressive,q_80,w_800/1414228815325188681.jpg"></div>
        <div>Image2: <img src="https://i.kinja-img.com/gawker-media/image/upload/s--pEKSmwzm--/c_scale,fl_progressive,q_80,w_800/1414228815325188681.jpg"></div>

    </div>
    </body>
</html>

